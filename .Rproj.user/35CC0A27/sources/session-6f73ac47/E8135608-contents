library(tidyverse)
library(here)
library(rio)
library(janitor)
library(dplyr)
library(stringr)
library(data.table)
library(tcltk)
library(haven)

#Pick where your directory is. 
#I have a file in mine called "data" where the data is pulled 
#from in the next step
dir <- tclvalue(tkchooseDirectory())

# Import data set
lith <- import(here("data","LithStrat.sav"), setclass="tbl_df" ) %>%
  clean_names()

# Assign a word (whatever you want to find in the data; in this case the number 1-7) to a variable name
present1 <- '1'
present2 <- '2'
present3 <- '3'
present4 <- '4'
present5 <- '5'
present6 <- '6'
present7 <- '7'

# Detects whether that word is present in the sentence, and if it is it returns a 1 in the variable name you point to (s1-s7)
lith$s1 <- as.integer(str_detect(lith$strat, present1))
lith$s2 <- as.integer(str_detect(lith$strat, present2))
lith$s3 <- as.integer(str_detect(lith$strat, present3))
lith$s4 <- as.integer(str_detect(lith$strat, present4))
lith$s5 <- as.integer(str_detect(lith$strat, present5))
lith$s6 <- as.integer(str_detect(lith$strat, present6))
lith$s7 <- as.integer(str_detect(lith$strat, present7))

# Makes sure it's set as a data frame
lith <- as.data.frame(lith)

# Exports file to .sav (either way should work)
write_sav(lith, path = paste(dir, "/", "LithStratScored.sav", sep = ""))
export(lith, file = paste(dir, "/", "LithStrat.csv", sep = ""))
